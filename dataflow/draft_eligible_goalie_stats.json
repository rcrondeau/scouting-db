{
	"name": "draft_eligible_goalie_stats",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "sdb_model_stats_goalie",
						"type": "DatasetReference"
					},
					"name": "goaliestats"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "draftEligible"
				},
				{
					"name": "removeColumns"
				}
			],
			"scriptLines": [
				"source(output(",
				"          p_key as string,",
				"          Player_Height as string,",
				"          height_cm as double,",
				"          player_image as string,",
				"          player_id as string,",
				"          name as string,",
				"          Position as string,",
				"          draft_season as double,",
				"          draft_eligible as string,",
				"          years_eligible as double,",
				"          age_at_draft as double,",
				"          team_name as string,",
				"          birthdate as string,",
				"          homeplace as string,",
				"          draft_key as string,",
				"          season_name as string,",
				"          GP as integer,",
				"          shots_against as double,",
				"          shots_against_50 as double,",
				"          shots_against_75 as double,",
				"          goals_against as double,",
				"          goals_against_50 as double,",
				"          goals_against_75 as double,",
				"          seconds_on_ice as double,",
				"          seconds_on_ice_50 as double,",
				"          seconds_on_ice_75 as double,",
				"          saves as double,",
				"          saves_50 as double,",
				"          saves_75 as double,",
				"          team_shots_against as double,",
				"          team_shots_against_50 as double,",
				"          team_shots_against_75 as double,",
				"          team_goals_against as double,",
				"          team_goals_against_50 as double,",
				"          team_goals_against_75 as double,",
				"          team_seconds_on_ice as double,",
				"          team_seconds_on_ice_50 as double,",
				"          team_seconds_on_ice_75 as double,",
				"          team_saves as double,",
				"          team_saves_50 as double,",
				"          team_saves_75 as double,",
				"          GAA as double,",
				"          GAA_50 as double,",
				"          GAA_75 as double,",
				"          Team_GAA as double,",
				"          Team_GAA_50 as double,",
				"          Team_GAA_75 as double,",
				"          SAV as double,",
				"          SAV_50 as double,",
				"          SAV_75 as double,",
				"          Team_SAV as double,",
				"          Team_SAV_50 as double,",
				"          Team_SAV_75 as double,",
				"          GAA_Diff_Team as double,",
				"          GAA_Diff_Team_50 as double,",
				"          GAA_Diff_Team_75 as double,",
				"          SAV_Diff_Team as double,",
				"          SAV_Diff_Team_50 as double,",
				"          SAV_Diff_Team_75 as double,",
				"          SAV_Diff_50 as double,",
				"          SAV_Diff_75 as double,",
				"          prank_sav as double,",
				"          prank_sav_50 as double,",
				"          prank_sav_75 as double,",
				"          prank_gaa_diff_team as double,",
				"          prank_gaa_diff_team_50 as double,",
				"          prank_gaa_diff_team_75 as double,",
				"          prank_sav_diff_team as double,",
				"          prank_sav_diff_team_50 as double,",
				"          prank_sav_diff_team_75 as double,",
				"          prank_sav_diff_50 as double,",
				"          prank_sav_diff_75 as double,",
				"          zscore_sav as double,",
				"          zscore_sav_50 as double,",
				"          zscore_sav_75 as double,",
				"          zscore_gaa_diff_team as double,",
				"          zscore_gaa_diff_team_50 as double,",
				"          zscore_gaa_diff_team_75 as double,",
				"          zscore_sav_diff_team as double,",
				"          zscore_sav_diff_team_50 as double,",
				"          zscore_sav_diff_team_75 as double,",
				"          zscore_sav_diff_50 as double,",
				"          zscore_sav_diff_75 as double,",
				"          playerId as double,",
				"          first_pro_season as string,",
				"          first_draft_year as double,",
				"          pro_games as double,",
				"          pro_sav as double,",
				"          pro_gaa as double,",
				"          draft_year as double,",
				"          pick_number as double,",
				"          nhl_team_name as string,",
				"          nhl_team_code as string,",
				"          amateur_league as string,",
				"          years_pro as double,",
				"          age_in_days as double,",
				"          amateur_league_2 as string,",
				"          age_in_days_2 as double,",
				"          draft_year_2 as double,",
				"          pro_seasons as double,",
				"          seasons_since_draft as double,",
				"          pro_games_per_season as double,",
				"          pro_per_sav as double,",
				"          pro_per_games_per_season as double,",
				"          pro_per_gaa as double,",
				"          pro_sav_game as double,",
				"          pro_per_sav_game as double,",
				"          player_cat as string,",
				"          is_drafted as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> goaliestats",
				"removeColumns filter(draft_eligible == 'Y') ~> draftEligible",
				"goaliestats select(mapColumn(",
				"          p_key,",
				"          Player_Height,",
				"          height_cm,",
				"          player_id,",
				"          name,",
				"          Position,",
				"          draft_season,",
				"          draft_eligible,",
				"          years_eligible,",
				"          age_at_draft,",
				"          team_name,",
				"          birthdate,",
				"          homeplace,",
				"          draft_key,",
				"          season_name,",
				"          GP,",
				"          shots_against,",
				"          shots_against_50,",
				"          shots_against_75,",
				"          goals_against,",
				"          goals_against_50,",
				"          goals_against_75,",
				"          seconds_on_ice,",
				"          seconds_on_ice_50,",
				"          seconds_on_ice_75,",
				"          saves,",
				"          saves_50,",
				"          saves_75,",
				"          team_shots_against,",
				"          team_shots_against_50,",
				"          team_shots_against_75,",
				"          team_goals_against,",
				"          team_goals_against_50,",
				"          team_goals_against_75,",
				"          team_seconds_on_ice,",
				"          team_seconds_on_ice_50,",
				"          team_seconds_on_ice_75,",
				"          team_saves,",
				"          team_saves_50,",
				"          team_saves_75,",
				"          GAA,",
				"          GAA_50,",
				"          GAA_75,",
				"          Team_GAA,",
				"          Team_GAA_50,",
				"          Team_GAA_75,",
				"          SAV,",
				"          SAV_50,",
				"          SAV_75,",
				"          Team_SAV,",
				"          Team_SAV_50,",
				"          Team_SAV_75,",
				"          GAA_Diff_Team,",
				"          GAA_Diff_Team_50,",
				"          GAA_Diff_Team_75,",
				"          SAV_Diff_Team,",
				"          SAV_Diff_Team_50,",
				"          SAV_Diff_Team_75,",
				"          SAV_Diff_50,",
				"          SAV_Diff_75,",
				"          prank_sav,",
				"          prank_sav_50,",
				"          prank_sav_75,",
				"          prank_gaa_diff_team,",
				"          prank_gaa_diff_team_50,",
				"          prank_gaa_diff_team_75,",
				"          prank_sav_diff_team,",
				"          prank_sav_diff_team_50,",
				"          prank_sav_diff_team_75,",
				"          prank_sav_diff_50,",
				"          prank_sav_diff_75,",
				"          zscore_sav,",
				"          zscore_sav_50,",
				"          zscore_sav_75,",
				"          zscore_gaa_diff_team,",
				"          zscore_gaa_diff_team_50,",
				"          zscore_gaa_diff_team_75,",
				"          zscore_sav_diff_team,",
				"          zscore_sav_diff_team_50,",
				"          zscore_sav_diff_team_75,",
				"          zscore_sav_diff_50,",
				"          zscore_sav_diff_75,",
				"          age_in_days,",
				"          player_cat,",
				"          is_drafted",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> removeColumns"
			]
		}
	}
}